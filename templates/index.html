{% extends "base.html" %}

{% block content %}
    <h1 class="mt-4">Pitching Analysis</h1>
    <form action="/" method="post" class="row g-3 align-items-end">
        <div class="col-auto">
            <label for="start_date" class="form-label">Start Date:</label>
            <input type="date" id="start_date" name="start_date" class="form-control" value="{{ start_date }}">
        </div>
        <div class="col-auto">
            <label for="end_date" class="form-label">End Date:</label>
            <input type="date" id="end_date" name="end_date" class="form-control" value="{{ end_date }}">
        </div>
        <div class="col-auto">
            <label for="num_pitchers" class="form-label">Top/Bottom N:</label>
            <input type="number" id="num_pitchers" name="num_pitchers" class="form-control" value="{{ num_pitchers }}">
        </div>
        <div class="col-auto">
            <button type="submit" class="btn btn-primary">Get Data</button>
        </div>
    </form>

    {% if top_pitchers_data %}
        <h2 class="mt-5">Top {{ num_pitchers }} Starters</h2>
        {% for pitcher in top_pitchers_data %}
            <div class="card mt-3">
                <div class="card-header">
                    <strong>{{ pitcher.stats.player_name }}</strong> vs {{ pitcher.stats.home_team }}
                </div>
                <div class="card-body">
                    <p>
                        Total Pitches: {{ pitcher.stats.total_pitches }} | 
                        ERA: {{ "%.2f"|format(pitcher.stats.ERA) }} | 
                        WHIP: {{ "%.2f"|format(pitcher.stats.WHIP) }} | 
                        K/9: {{ "%.2f"|format(pitcher.stats['K/9']) }} | 
                        BB/9: {{ "%.2f"|format(pitcher.stats['BB/9']) }} | 
                        HR/9: {{ "%.2f"|format(pitcher.stats['HR/9']) }}
                    </p>
                    <div class="table-responsive">
                        {{ pitcher.summary|safe }}
                    </div>
                </div>
            </div>
        {% endfor %}
    {% endif %}

    {% if bottom_pitchers_data %}
        <h2 class="mt-5">Bottom {{ num_pitchers }} Starters</h2>
        {% for pitcher in bottom_pitchers_data %}
            <div class="card mt-3">
                <div class="card-header">
                    <strong>{{ pitcher.stats.player_name }}</strong> vs {{ pitcher.stats.home_team }}
                </div>
                <div class="card-body">
                    <p>
                        Total Pitches: {{ pitcher.stats.total_pitches }} | 
                        ERA: {{ "%.2f"|format(pitcher.stats.ERA) }} | 
                        WHIP: {{ "%.2f"|format(pitcher.stats.WHIP) }} | 
                        K/9: {{ "%.2f"|format(pitcher.stats['K/9']) }} | 
                        BB/9: {{ "%.2f"|format(pitcher.stats['BB/9']) }} | 
                        HR/9: {{ "%.2f"|format(pitcher.stats['HR/9']) }}
                    </p>
                    <div class="table-responsive">
                        {{ pitcher.summary|safe }}
                    </div>
                </div>
            </div>
        {% endfor %}
    {% endif %}
{% endblock %}
